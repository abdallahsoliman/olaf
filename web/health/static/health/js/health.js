// Generated by CoffeeScript 1.10.0
(function() {
  var formatHeartRateData, heartRateChart;

  swampdragon.open(function() {
    swampdragon.subscribe('heart-rate', 'heart-rate', null, (function(context, data) {}), function(context, data) {});
  });

  swampdragon.close(function() {});

  swampdragon.ready(function() {});

  swampdragon.onChannelMessage(function(channels, message) {
    if (channels[0] === "heart-rate" && message.action === "created") {
      heartRateChart.push(formatHeartRateData([message.data]));
    }
  });

  formatHeartRateData = function(heartRates) {
    var heartRate, i, len, values;
    values = [];
    for (i = 0, len = heartRates.length; i < len; i++) {
      heartRate = heartRates[i];
      values.push({
        time: new Date(heartRate.date).getTime() / 1000,
        y: heartRate.value
      });
    }
    return values;
  };

  heartRateChart = $('#heart-rate-graph').epoch({
    type: 'time.line',
    data: [
      {
        label: 'Heart Rate',
        values: formatHeartRateData(data),
        range: [0, 100],
        ticks: {
          left: 10
        }
      }
    ],
    axes: ['bottom', 'left'],
    ticks: {
      bottom: 10,
      left: 5
    },
    margins: {
      top: 25,
      right: 25,
      bottom: 25,
      left: 25
    }
  });

  formatHeartRateData(data);

}).call(this);
